(this["webpackJsonpmonday-integration-quickstart-app"]=this["webpackJsonpmonday-integration-quickstart-app"]||[]).push([[0],{42:function(e,t,n){e.exports=n(81)},47:function(e,t,n){},49:function(e,t,n){},78:function(e,t,n){e.exports=n.p+"static/media/esl-logo.90002ad2.jpg"},81:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(2),s=n.n(a),c=(n(47),n(1)),i=n.n(c),l=n(12),u=n(4),p=n(24),m=n(25),d=n(32),h=n(31),f=(n(49),n(26)),v=n.n(f),b=(n(64),"https://outaddin-dev.herokuapp.com/api");function g(){return(g=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(b+"/user/isUserExist",{method:"post",body:JSON.stringify({email:"anistav1@outlook.com"}),headers:{"Content-Type":"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:e.prev=10,e.t0=e.catch(0),console.dir(e.t0),console.log("ERROR: cannot fetch from server",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function k(){return(k=Object(u.a)(i.a.mark((function e(t,n,r,o){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("process.env.NODE_ENV: ","production"),console.log("email, boardId, groupId, itemId: ",t,n,r,o),e.prev=2,e.next=5,fetch(b+"/user/setStartItem",{method:"post",body:JSON.stringify({email:t,boardId:n,groupId:r,itemId:o}),headers:{"Content-Type":"application/json"}});case 5:return a=e.sent,e.next=8,a.json();case 8:return a=e.sent,console.log("setStartItem -> res",a),e.abrupt("return",a);case 13:e.prev=13,e.t0=e.catch(2),console.dir(e.t0),console.log("ERROR: cannot fetch from server",e.t0);case 17:case"end":return e.stop()}}),e,null,[[2,13]])})))).apply(this,arguments)}var x={setStartItem:function(e,t,n,r){return k.apply(this,arguments)},isUserExist:function(e){return g.apply(this,arguments)}},E=(n(65),n(27)),y=n.n(E),w=(n(76),n(91)),S=(n(78),v()()),I=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(p.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).state={settings:{},name:"",color:"primary",isShowTxt:!1,isUserExist:!0},e.setItemToStart=Object(u.a)(i.a.mark((function t(){var n,r,o,a,s,c,u,p,m,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.isUserExist&&"positive"!==e.state.color){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,S.get("context");case 5:return n=t.sent,r=n.data,o=r.boardId,a=r.itemId,s="query {\n      boards (ids: ".concat(o,") {\n        name\n        groups {\n          id\n          items{\n            id\n            name\n          }\n        }\n      }\n      me { \n        name\n        email\n      }\n      \n    }"),t.next=12,S.api(s);case 12:return c=t.sent,u=c.data.me.email,t.next=16,x.isUserExist(u);case 16:if(p=t.sent,console.log("setItemToStart= -> userTest",p),p&&!(null===p||void 0===p?void 0:p.error)){t.next=21;break}return e.setState({isUserExist:!1,color:"negative"}),t.abrupt("return");case 21:return console.log("setItemToStart= -> userTest",p),m=c.data.boards[0].groups,d=m.find((function(e){return e.items.some((function(e){return+e.id===a}))})).id,t.next=26,x.setStartItem(u,o,d,a);case 26:e.setState(Object(l.a)(Object(l.a)({},e.state),{},{color:"positive",isShowTxt:!e.state.isShowTxt})),t.next=32;break;case 29:t.prev=29,t.t0=t.catch(2),console.log("err check if user exist: ",t.t0);case 32:case"end":return t.stop()}}),t,null,[[2,29]])}))),e}return Object(m.a)(n,[{key:"navToStore",value:function(){window.open("https://appsource.microsoft.com/en-us/product/office/WA200002596?tab=Overview")}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement("section",{className:"app-link"},o.a.createElement(w.a,{className:"btn-icon",iconName:"Refresh",color:"blue"},"Refresh"),o.a.createElement("h3",null,"ESL's monday.com for outlook"),o.a.createElement(y.a,{color:this.state.color,className:"success",onClick:this.setItemToStart},"Work on this item from Outlook"),this.state.isShowTxt&&o.a.createElement("div",null,o.a.createElement("p",null,"Job done! This item has been set as your last state"),o.a.createElement("p",null,"Please click the refresh button to view it with in outlook")),!this.state.isUserExist&&o.a.createElement("div",null,o.a.createElement("p",null,"We're sorry, but it seems like you are not registerd in ESl's monday.com for outlook"),o.a.createElement("p",null,"Please click the ",o.a.createElement("span",{onClick:this.navToStore},"here")," to sign in"))))}}]),n}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[42,1,2]]]);
//# sourceMappingURL=main.ab5c9dec.chunk.js.map